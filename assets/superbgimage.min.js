var SuperBGImage=new Class({Implements:[Options],Binds:["scrollIE6","load","preload","startSlideShow","stopSlideshow","nextSlide","prevSlide","resize","calcSize","showImage","loadImage","transition"],options:{id:"superbgimage",z_index:-1,inlineMode:0,showimage:1,vertical_center:1,horizontal_center:1,min_width:0,min_height:0,transition:1,transitionout:1,randomtransition:0,showtitle:0,slideshow:0,slide_interval:5000,randomimage:0,speed:600,preload:1,onShow:null,onClick:null,onHide:null,onMouseenter:null,onMouseleave:null,onMousemove:null},inAnimation:false,slideshowActive:false,imgIndex:1,imgActual:1,imgLast:-1,imgSlide:0,interval:0,preload:0,direction:0,max_randomtrans:7,lasttrans:-1,isIE6:false,firstLoaded:false,initialize:function(b,a){this.setOptions(a);this.element=document.getElement(b);this.container=document.id(this.options.id);if(!this.container){this.container=new Element("div",{id:this.options.id})}document.id(document.body).grab(this.container,"top");this.container.setStyles({display:"none",overflow:"hidden","z-index":this.options.z_index});if(this.options.inlineMode===0){this.container.setStyles({position:"fixed",width:"100%",height:"100%",top:0,left:0})}if(this.options.reload){this.container.getElements("img").dispose()}this.container.getElements("img").fade("hide").setStyles({position:"absolute","max-width":"none"});this.container.getChildren("img").forEach((function(c){c.set("rel",this.imgIndex++);if(!this.options.showtitle){c.set("title","")}}).bind(this));this.element.getChildren("a").forEach((function(d,c){d.set("rel",this.imgIndex++).addEvent("click",(function(){this.showImage(++c);return false}).bind(this)).addClass("preload")}).bind(this));this.imgIndex--;window.addEvent("load",this.load);window.addEvent("resize",this.resize);this.isIE6=/msie|MSIE 6/.test(navigator.userAgent);if(this.isIE6&&(this.options.inlineMode===0)){this.container.setStyles({position:"absolute",width:window.getSize().x,height:window.getSize().y});window.addEvent("scroll",this.scrollIE6)}if(this.options.reload){this.load()}return this},scrollIE6:function(){this.container.setStyle("top",document.documentElement.scrollTop+"px")},load:function(){if((this.container.getChildren("img").length>0)||(this.element.getChildren("a").length>0)){this.container.setStyle("display","block")}if((typeof this.options.showimage!="undefined")&&(this.options.showimage>=0)){this.imgActual=this.options.showimage}if(this.options.randomimage===1){this.imgActual=(1+parseInt(Math.random()*(this.imgIndex-1+1),10))}this.showImage(this.imgActual)},preload:function(){clearInterval(this.preloadTimer);if(!this.firstLoaded&&(this.element.getChildren("a").length>0)){this.preloadTimer=setInterval(this.preload,111);return}var d=this.element.getFirst("a.preload");if(!d){return}var b=d.get("rel");var a=d.get("title");var c=Asset.image(d.get("href"),{onLoad:(function(){c.setStyles({position:"absolute","max-width":"none"}).fade("hide");if(this.container.getChildren("img[rel='"+b+"']").length===0){c.set("rel",b);if(this.options.showtitle===1){c.set("title",a)}this.container.grab(c,"top")}}).bind(this)});this.preloadTimer=setInterval(this.preload,111);d.removeClass("preload")},startSlideShow:function(){this.imgSlide=this.imgActual;if(this.interval!==0){clearInterval(this.interval)}this.interval=setInterval(this.nextSlide,this.options.slide_interval);this.slideshowActive=true;return false},stopSlideShow:function(){clearInterval(this.interval);this.slideshowActive=false;return false},nextSlide:function(){if(this.inAnimation){return false}if(this.slideshowActive){clearInterval(this.preloadTimer)}this.direction=0;this.imgSlide++;if(this.imgSlide>this.imgIndex){this.imgSlide=1}if(this.options.randomimage===1){this.imgSlide=(1+parseInt(Math.random()*(this.imgIndex-1+1),10));while(this.imgSlide===this.imgLast){this.imgSlide=(1+parseInt(Math.random()*(this.imgIndex-1+1),10))}}this.imgActual=this.imgSlide;return this.showImage(this.imgActual)},prevSlide:function(){if(this.inAnimation){return false}this.direction=1;this.imgSlide--;if(this.imgSlide<1){this.imgSlide=this.imgIndex}if(this.options.randomimage===1){this.imgSlide=(1+parseInt(Math.random()*(this.imgIndex-1+1),10));while(this.imgSlide===this.imgLast){this.imgSlide=(1+parseInt(Math.random()*(this.imgIndex-1+1),10))}}this.imgActual=this.imgSlide;return this.showImage(this.imgActual)},resize:function(){var e=this.container.getElement("img.activeslide");if(!e){return}var d=this.calcSize(e.getSize().x,e.getSize().y);var a=d[0];var b=d[1];var f=d[2];var c=d[3];e.setStyle("width",a+"px");e.setStyle("height",b+"px");if(this.isIE6&&(this.options.inlineMode===0)){this.container.setStyles({width:a,height:b});e.setStyle("width",a);e.setStyle("height",b)}if(this.options.horizontal_center===1){e.setStyle("left",f+"px")}else{e.setStyle("left","0px")}if(this.options.vertical_center===1){e.setStyle("top",c+"px")}else{e.setStyle("top","0px")}},calcSize:function(b,j){var a,d,g,i;if(this.options.inlineMode===1){a=this.container.getSize().x;d=this.container.getSize().y}else{a=window.getSize().x;d=window.getSize().y}var f=j/b;if(this.options.min_width>0&&this.options.min_width>=a){a=this.options.min_width}if(this.options.min_height>0&&this.options.min_height>=d){d=this.options.min_height}if((d/a)>f){i=d;g=Math.round(d/f)}else{i=Math.round(a*f);g=a}var c=Math.round((a-g)/2);var e=Math.round((d-i)/2);var h=[g,i,c,e];return h},showImage:function(b){this.imgActual=b;if(this.container.getElement("img.activeslide")&&this.container.getElement("img.activeslide").get("rel")===this.imgActual){return false}if(this.inAnimation){return false}else{this.inAnimation=true}var c="";var a="";if(this.container.getElements("img[rel='"+this.imgActual+"']").length===0){c=this.element.getElement("a[rel='"+this.imgActual+"']").get("href");a=this.element.getElement("a[rel='"+this.imgActual+"']").get("title")}else{c=this.container.getFirst("img[rel='"+this.imgActual+"']").get("src")}if((typeof this.options.onHide==="function")&&(this.options.onHide!==null)&&(this.imgLast>=0)){this.options.onHide(this.imgLast)}this.loadImage(c,a);this.element.getElements("a").removeClass("activeslide");this.element.getElement("a[rel='"+this.imgActual+"']").addClass("activeslide");this.imgSlide=this.imgActual;this.imgLast=this.imgActual;return false},loadImage:function(e,a){if(this.container.getChildren("img[rel='"+this.imgActual+"']").length===0){var b=Asset.image(e,{onLoad:(function(){b.setStyles({position:"absolute","max-width":"none"}).fade("hide");if(this.container.getChildren("img[rel='"+this.imgActual+"']").length===0){b.set("rel",this.imgActual);if(this.options.showtitle===1){b.setAttribute("title",a)}this.container.grab(b,"top")}var g=this.container.getFirst("img[rel='"+this.imgActual+"']");var f=this.calcSize(b.getSize().x,b.getSize().y);this.transition(g,f);if(!this.firstLoaded){if(this.options.slideshow===1){this.startSlideShow()}if((this.options.preload===1)&&(this.element.getChildren("a").length>0)){this.preloadTimer=setInterval(this.preload,250)}}this.firstLoaded=true}).bind(this),onError:(function(){this.inAnimation=false}).bind(this)})}else{var d=this.container.getFirst("img[rel='"+this.imgActual+"']");var c=this.calcSize(d.getSize().x,d.getSize().y);this.transition(d,c);if(!this.firstLoaded){if(this.options.slideshow===1){this.startSlideShow()}if((this.options.preload===1)&&(this.element.getChildren("a").length>0)){this.preloadTimer=setInterval(this.preload,250)}this.firstLoaded=true}}},transition:function(b,a){var j=a[0];var k=a[1];var g=a[2];var i=a[3];b.setStyles({width:j+"px",height:k+"px",left:g+"px"});if((typeof this.options.onClick==="function")&&(this.options.onClick!==null)){b.removeEvents("click").addEvent("click",(function(){this.options.onClick(this.imgActual)}).bind(this))}if((typeof this.options.onMouseenter==="function")&&(this.options.onMouseenter!==null)){b.removeEvents("mouseenter").addEvent("mouseenter",(function(){this.options.onMouseenter(this.imgActual)}).bind(this))}if((typeof this.options.onMouseleave==="function")&&(this.options.onMouseleave!==null)){b.removeEvents("mouseleave").addEvent("mouseleave",(function(){this.options.onMouseleave(this.imgActual)}).bind(this))}if((typeof this.options.onMousemove==="function")&&(this.options.onMousemove!==null)){b.removeEvents("mousemove").addEvent("mousemove",(function(l){this.options.onMousemove(this.imgActual,l)}).bind(this))}if(this.options.randomtransition===1){var d=(0+parseInt(Math.random()*(this.max_randomtrans-0+1),10));while(d===this.lasttrans){d=(0+parseInt(Math.random()*(this.max_randomtrans-0+1),10))}this.options.transition=d}if(this.options.vertical_center===1){b.setStyle("top",i+"px")}else{b.setStyle("top","0px")}var c=this.options.transitionout;if((this.options.transition===6)||(this.options.transition===7)){c=0}if(c===1){!this.container.getFirst("img.activeslide")||this.container.getFirst("img.activeslide").removeClass("activeslide").addClass("lastslide").setStyle("z-index",0)}else{!this.container.getFirst("img.activeslide")||this.container.getFirst("img.activeslide").removeClass("activeslide").addClass("lastslideno").setStyle("z-index",0)}b.setStyle("z-index",1);this.options.transition=parseInt(this.options.transition,10);this.lasttrans=this.options.transition;var e="";var f="";if(this.options.transition===0){b.get("tween").chain((function(){if((typeof this.options.onShow==="function")&&(this.options.onShow!==null)){this.options.onShow(this.imgActual)}this.inAnimation=false;if(this.slideshowActive){this.startSlideShow()}}).bind(this));b.fade("show").addClass("activeslide")}else{if(this.options.transition===1){b.get("tween").chain((function(){if((typeof this.options.onShow==="function")&&(this.options.onShow!==null)){this.options.onShow(this.imgActual)}!this.container.getFirst("img.lastslideno")||this.container.getFirst("img.lastslideno").fade("hide").removeClass("lastslideno");this.inAnimation=false;if(this.slideshowActive){this.startSlideShow()}}).bind(this));b.set("tween",{duration:this.options.speed}).fade("in").addClass("activeslide")}else{}}if(c===1){var h=this.options.speed;if(this.options.speed=="slow"){h=600+200}else{if(this.options.speed=="normal"){h=400+200}else{if(this.options.speed=="fast"){h=400+200}else{h=this.options.speed+200}}}if(this.options.transition===0){!this.container.getFirst("img.lastslide")||this.container.getFirst("img.lastslide").fade("hide").removeClass("lastslide")}else{if(this.options.transition==1){!this.container.getFirst("img.lastslide")||this.container.getFirst("img.lastslide").set("tween",{duration:h}).fade("out").removeClass("lastslide")}else{}}}else{this.container.getFirst("img.lastslide").fade("hide").removeClass("lastslide")}}});